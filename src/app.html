<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <title>MAW</title>
  <script src="jquery-1.7.1.min.js"></script>
  <script src="ember-0.9.4.min.js"></script>

  <script src="app.js"></script>

  <link rel="stylesheet" type="text/css" href="assets/app.css" />

  <script src="models/model.js"></script>
  <script src="models/audioNode.js"></script>
  <script src="models/wavetableOscillator.js"></script>
  <script src="models/sineWave.js"></script>
  <script src="models/squareWave.js"></script>
  <script src="models/triangleWave.js"></script>
  <script src="models/sawWave.js"></script>
  <script src="models/whiteNoiseWave.js"></script>
  <script src="models/amplifier.js"></script>
  <script src="models/output.js"></script>

  <script src="views/appView.js"></script>
  <script src="views/widgetView.js"></script>
  <script src="views/audioNodeView.js"></script>
  <script src="views/sineWaveView.js"></script>
  <script src="views/squareWaveView.js"></script>
  <script src="views/triangleWaveView.js"></script>
  <script src="views/sawWaveView.js"></script>
  <script src="views/whiteNoiseWaveView.js"></script>
  <script src="views/amplifierView.js"></script>
  <script src="views/outputView.js"></script>
  <script src="views/audioPalatteView.js"></script>

  <script src="init.js"></script>
</head>
<body>
<script type="text/x-handlebars">
{{#view Maw.AppView modelBinding="Maw.model"}}
  <h1>{{model.data}}</h1>
  {{#view Maw.AudioPalatteView id="nodes"}}
    {{view Maw.WhiteNoiseWaveView}}
    {{view Maw.SineWaveView}}
    {{view Maw.SquareWaveView}}
    {{view Maw.TriangleWaveView}}
    {{view Maw.SawWaveView}}
  {{/view}}
{{/view}}

</script>
</body>

<!-- View Components -->
<script type="text/x-handlebars" data-template-name="widget">
  <g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Canvas 1</title><g><title>Layer 1</title><rect x="135.999985" y="296.88397" width="121.000046" height="79.11603" fill="white"/><rect x="135.999985" y="296.88397" width="121.000046" height="79.11603" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><path d="M 156.16666 356.3272 L 176.33336 316.7692 L 216.66673 316.7692 L 236.83342 356.3272" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/></g></g>
</script>

<script type="text/javascript">
  var context;
  window.addEventListener('load', init, false);
  function init() {
    try {
      context = new webkitAudioContext();
      playSound(createWave());
    }
    catch(e) {
      alert('Web Audio API is not supported in this browser');
    }
  }

  function playSound(buffer) {
    var source = context.createBufferSource();
    source.loop = true;
    source.buffer = buffer;
    source.playbackRate = 2;
    source.connect(context.destination);
    // source.noteOn(0);
  }

  function createWave() {

     var buffer = context.createBuffer(1, 1024, 44100);

     var p = buffer.getChannelData(0);
     for (var i = 0; i < 1024; ++i) {
         p[i] = Math.sin(2*Math.PI*i/1024 * 44100);
     }
     return buffer;
  }

</script>

</html>
